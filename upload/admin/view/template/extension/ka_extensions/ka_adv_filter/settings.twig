{#
    $Project: Advanced Filter $
    $Author: karapuz team <support@ka-station.com> $
    $Version: 1.0.1.2 $ ($Revision: 60 $)
#}{{ header }}{{ column_left }} 

<div id="content">

	<div class="page-header">
		<div class="container-fluid">
		  <div class="pull-right">
			<button type="submit" form="form-settings" data-toggle="tooltip" title="{{ t('button_save') }}" class="btn btn-primary"><i class="fa fa-check-circle"></i> {{ t('button_save') }}</button>
			<a href="{{ cancel }}" data-toggle="tooltip" title="{{ t('button_cancel') }}" class="btn btn-default"><i class="fa fa-reply"></i>  {{ t('button_cancel') }}</a>
		  </div>
		  <h1><i class="fa fa-puzzle-piece"></i> {{ heading_title }}</h1>
		  {{ ka_breadcrumbs }} 
		</div>
	</div>

	<div class="container-fluid">
		{{ ka_top }} 

		<div class="panel panel-default">
			<div class="panel-body">

				<div id="service_line">
					<table>
						<tr>
							<td><b>Module Version</b>: {{ extension_version }}&nbsp;&nbsp;&nbsp;</td>
							<td><b>Author</b>: karapuz&nbsp;&nbsp;&nbsp;</td>
							<td><b>Contact Us</b>: <a href="mailto:support@ka-station.com">via email</a>&nbsp;&nbsp;&nbsp;</td>
							<td><a href="https://www.ka-station.com/index.php?route=information/contact" target="_blank">via secure form at www.ka-station.com</a>&nbsp;&nbsp;&nbsp;</td>
						</tr>
					</table>
					<br />
				</div>
					  
				<form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-settings" class="form-horizontal">
				  <input type="hidden" name="mode" value="update" id="mode" />
				  
					<div class="form-group">
						<label class="col-sm-4 control-label" for="is_price_search_shown">Show Price Search</label>
						<div class="col-sm-8">
							<label class="checkbox-inline">
								<input type="checkbox" name="ka_adv_filter_is_price_search_shown" id="is_price_search_shown" class="form-control" autocomplete="off" value="1"  {% if ka_adv_filter_is_price_search_shown %} checked="checked" {% endif %} />
							</label>
						</div>
					</div>
				  
					<div class="form-group">
						<label class="col-sm-4 control-label" for="price_range_look">Price Range Look</label>
						<div class="col-sm-8">
							<select name="ka_adv_filter_price_range_look" id="price_range_look" class="form-control" autocomplete="off">
								<option value="ruler" {% if ka_adv_filter_price_range_look == "ruler"%} selected="selected" {% endif %}>Ruler</option>
								<option value="intervals" {% if ka_adv_filter_price_range_look == "intervals"%} selected="selected" {% endif %}>Intervals</option>
								<option value="ruler_and_intervals" {% if ka_adv_filter_price_range_look == "ruler_and_intervals"%} selected="selected" {% endif %}>Ruler And Intervals</option>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label" for="price_intervals"><span data-toggle="tooltip" title="Each number specifices a start of the next internal, i.e. if you define &quot;10;50;200&quot; then it will be converted to intervals:&lt;br&gt;0 - 9.99&lt;br&gt;10 - 49.99&lt;br&gt;50 - 199.99&lt;br&gt;200 and more">Price Intervals</span></label>
						<div class="col-sm-8">
							<textarea id="price_intervals" rows="5" name="ka_adv_filter_price_intervals" class="form-control">{{ ka_adv_filter_price_intervals }}</textarea>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label" for="price_intervals_layout">Price Intervals Layout</label>
						<div class="col-sm-8">
							<select name="ka_adv_filter_price_intervals_layout" id="price_intervals_layout" class="form-control" autocomplete="off">
								<option value="radio" {% if ka_adv_filter_price_intervals_layout == 'radio' %} selected="selected" {% endif %}>Radio Buttons</option>
								<option value="dropdown" {% if ka_adv_filter_price_intervals_layout == 'dropdown' %} selected="selected" {% endif %}>Drop-Down Box</option>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-sm-4 control-label" for="price_step"><span data-toggle="tooltip" title="Specifies a step on the ruler. It is for the 'ruler' look only">Min Price Step</span></label>
						<div class="col-sm-8">
							<input type="text" id="price_step" name="ka_adv_filter_price_step" class="form-control" value="{{ ka_adv_filter_price_step }}" />
						</div>
					</div>
				</form>
			</div>			
		</div>
		
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="form-group">
					<label class="col-sm-4 control-label" for="price_range_look">Rebuild Price Cache</label>
					<div class="col-sm-8">
						<p>
							{% if taxes_can_apply %}
								prices range will include taxes on the new rebuild
							{% else %}
								prices range will NOT include taxes on the new rebuild
							{% endif %}
							{% if tax_errors %}
								<div class="alert alert-warning">
									{{ tax_errors|join('<br />') }}
								</div>
							{% endif %}
						</p>
					
						<button form="form-rebuild" data-toggle="tooltip" onclick="javascript: onPriceRebuild();" title="{{ t('button_save') }}" class="btn btn-primary"><i class="fa fa-check-circle"></i> Rebuild</button>
						
						<p class="help-block">Last full rebuild: {{ last_rebuild }}</p>
						<p class="help-block">
					 	{% if ka_adv_filter_use_taxes %}
					 		{% if not taxes_can_apply %}WARNING: Taxes were included in the last rebuild{% endif%}
					 	{% else %}
					 		{% if taxes_can_apply %}WARNING: Taxes were NOT included in the last rebuild{% endif%}
					 	{% endif %}
					 	</p>
					</div>
				</div>
				{% if zones_intersect %}
				<div class="alert alert-danger">
					Prices with taxes are detected incorrectly when geo zones intersect each other. You have to setup geo zones so that they do not intersect each other inside one tax class.
				</div>
				<label class="control-label">Zone Intersection Errors</label>
				<textarea autocomplete="off" style="width: 100%" rows="10">{{ intersection_details|join('\n') }}</textarea>
				{% endif %}
			</div>
		</div>
	</div>
</div>

<script type="text/javascript"><!--

//--></script>

{% include 'extension/ka_extensions/ka_adv_filter/price_rebuild.twig' %}

{{ footer }}